class Tweet < ActiveRecord::Base

  MY_APPLICATION_NAME = "Social Integretion"
  
  """Connect to the Twitter API and pull down the latest tweets"""
  def self.get_latest(client)
    tweets = client.statuses.user_timeline? :screen_name => MY_APPLICATION_NAME # hit the API
    tweets.each do |t|
      created = DateTime.parse(t.created_at)
      # create the tweet if it doesn't already exist
      unless Tweet.exists?(["created=?", created])
        Tweet.create({:content => t.text, :created => created })
       end
    end
  end
  
  private
  def self.client(user)
    @user = user
    
    TwitterOAuth::Client.new(
    :consumer_key => 'AsAuRyGZP73Pr6863VS4Pg',
    :consumer_secret => '2bNk5FCvT39HzFN8eHPdbpFNKkaJHnxpQkZ6xz17sY',
    :token => @user.twitter_token,
    :secret => @user.twitter_secret
    )
  end
end